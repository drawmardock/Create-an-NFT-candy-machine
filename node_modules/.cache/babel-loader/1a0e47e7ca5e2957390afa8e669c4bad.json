{"ast":null,"code":"import _slicedToArray from\"/home/drawmardock/Desktop/dapp/solana-nft/metaplex/js/packages/candy-machine-ui/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"/home/drawmardock/Desktop/dapp/solana-nft/metaplex/js/packages/candy-machine-ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/home/drawmardock/Desktop/dapp/solana-nft/metaplex/js/packages/candy-machine-ui/node_modules/@babel/runtime/regenerator/index.js\";import*as anchor from'@project-serum/anchor';import{MintLayout,TOKEN_PROGRAM_ID,Token}from'@solana/spl-token';import{SystemProgram,SYSVAR_SLOT_HASHES_PUBKEY}from'@solana/web3.js';import{sendTransactions}from'./connection';import{CIVIC,getAtaForMint,getNetworkExpire,getNetworkToken,SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID}from'./utils';export var CANDY_MACHINE_PROGRAM=new anchor.web3.PublicKey('cndy3Z4yapfJBmL3ShUp5exZKqR3z33thTzeNMm2gRZ');var TOKEN_METADATA_PROGRAM_ID=new anchor.web3.PublicKey('metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s');export var awaitTransactionSignatureConfirmation=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(txid,timeout,connection){var queryStatus,done,status,subId,_args3=arguments;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:queryStatus=_args3.length>3&&_args3[3]!==undefined?_args3[3]:false;done=false;status={slot:0,confirmations:0,err:null};subId=0;_context3.next=6;return new Promise(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(resolve,reject){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setTimeout(function(){if(done){return;}done=true;console.log('Rejecting for timeout...');reject({timeout:true});},timeout);case 1:if(!(!done&&queryStatus)){_context2.next=7;break;}// eslint-disable-next-line no-loop-func\n_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var signatureStatuses;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return connection.getSignatureStatuses([txid]);case 3:signatureStatuses=_context.sent;status=signatureStatuses&&signatureStatuses.value[0];if(!done){if(!status){console.log('REST null result for',txid,status);}else if(status.err){console.log('REST error for',txid,status);done=true;reject(status.err);}else if(!status.confirmations){console.log('REST no confirmations for',txid,status);}else{console.log('REST confirmation for',txid,status);done=true;resolve(status);}}_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);if(!done){console.log('REST connection error: txid',txid,_context.t0);}case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}))();_context2.next=5;return sleep(2000);case 5:_context2.next=1;break;case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x4,_x5){return _ref2.apply(this,arguments);};}());case 6:status=_context3.sent;//@ts-ignore\nif(connection._signatureSubscriptions[subId]){connection.removeSignatureListener(subId);}done=true;console.log('Returning status',status);return _context3.abrupt(\"return\",status);case 11:case\"end\":return _context3.stop();}}},_callee3);}));return function awaitTransactionSignatureConfirmation(_x,_x2,_x3){return _ref.apply(this,arguments);};}();var createAssociatedTokenAccountInstruction=function createAssociatedTokenAccountInstruction(associatedTokenAddress,payer,walletAddress,splTokenMintAddress){var keys=[{pubkey:payer,isSigner:true,isWritable:true},{pubkey:associatedTokenAddress,isSigner:false,isWritable:true},{pubkey:walletAddress,isSigner:false,isWritable:false},{pubkey:splTokenMintAddress,isSigner:false,isWritable:false},{pubkey:anchor.web3.SystemProgram.programId,isSigner:false,isWritable:false},{pubkey:TOKEN_PROGRAM_ID,isSigner:false,isWritable:false},{pubkey:anchor.web3.SYSVAR_RENT_PUBKEY,isSigner:false,isWritable:false}];return new anchor.web3.TransactionInstruction({keys:keys,programId:SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,data:Buffer.from([])});};export var getCandyMachineState=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(anchorWallet,candyMachineId,connection){var provider,idl,program,state,itemsAvailable,itemsRedeemed,itemsRemaining;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:provider=new anchor.Provider(connection,anchorWallet,{preflightCommitment:'processed'});_context4.next=3;return anchor.Program.fetchIdl(CANDY_MACHINE_PROGRAM,provider);case 3:idl=_context4.sent;program=new anchor.Program(idl,CANDY_MACHINE_PROGRAM,provider);_context4.next=7;return program.account.candyMachine.fetch(candyMachineId);case 7:state=_context4.sent;itemsAvailable=state.data.itemsAvailable.toNumber();itemsRedeemed=state.itemsRedeemed.toNumber();itemsRemaining=itemsAvailable-itemsRedeemed;return _context4.abrupt(\"return\",{id:candyMachineId,program:program,state:{authority:state.authority,itemsAvailable:itemsAvailable,itemsRedeemed:itemsRedeemed,itemsRemaining:itemsRemaining,isSoldOut:itemsRemaining===0,isActive:false,isPresale:false,isWhitelistOnly:false,goLiveDate:state.data.goLiveDate,treasury:state.wallet,tokenMint:state.tokenMint,gatekeeper:state.data.gatekeeper,endSettings:state.data.endSettings,whitelistMintSettings:state.data.whitelistMintSettings,hiddenSettings:state.data.hiddenSettings,price:state.data.price,retainAuthority:state.data.retainAuthority}});case 12:case\"end\":return _context4.stop();}}},_callee4);}));return function getCandyMachineState(_x6,_x7,_x8){return _ref4.apply(this,arguments);};}();var getMasterEdition=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(mint){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return anchor.web3.PublicKey.findProgramAddress([Buffer.from('metadata'),TOKEN_METADATA_PROGRAM_ID.toBuffer(),mint.toBuffer(),Buffer.from('edition')],TOKEN_METADATA_PROGRAM_ID);case 2:return _context5.abrupt(\"return\",_context5.sent[0]);case 3:case\"end\":return _context5.stop();}}},_callee5);}));return function getMasterEdition(_x9){return _ref5.apply(this,arguments);};}();var getMetadata=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(mint){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return anchor.web3.PublicKey.findProgramAddress([Buffer.from('metadata'),TOKEN_METADATA_PROGRAM_ID.toBuffer(),mint.toBuffer()],TOKEN_METADATA_PROGRAM_ID);case 2:return _context6.abrupt(\"return\",_context6.sent[0]);case 3:case\"end\":return _context6.stop();}}},_callee6);}));return function getMetadata(_x10){return _ref6.apply(this,arguments);};}();export var getCandyMachineCreator=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(candyMachine){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return anchor.web3.PublicKey.findProgramAddress([Buffer.from('candy_machine'),candyMachine.toBuffer()],CANDY_MACHINE_PROGRAM);case 2:return _context7.abrupt(\"return\",_context7.sent);case 3:case\"end\":return _context7.stop();}}},_callee7);}));return function getCandyMachineCreator(_x11){return _ref7.apply(this,arguments);};}();export var getCollectionPDA=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(candyMachineAddress){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return anchor.web3.PublicKey.findProgramAddress([Buffer.from('collection'),candyMachineAddress.toBuffer()],CANDY_MACHINE_PROGRAM);case 2:return _context8.abrupt(\"return\",_context8.sent);case 3:case\"end\":return _context8.stop();}}},_callee8);}));return function getCollectionPDA(_x12){return _ref8.apply(this,arguments);};}();export var getCollectionAuthorityRecordPDA=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(mint,newAuthority){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return anchor.web3.PublicKey.findProgramAddress([Buffer.from('metadata'),TOKEN_METADATA_PROGRAM_ID.toBuffer(),mint.toBuffer(),Buffer.from('collection_authority'),newAuthority.toBuffer()],TOKEN_METADATA_PROGRAM_ID);case 2:return _context9.abrupt(\"return\",_context9.sent[0]);case 3:case\"end\":return _context9.stop();}}},_callee9);}));return function getCollectionAuthorityRecordPDA(_x13,_x14){return _ref9.apply(this,arguments);};}();export var mintOneToken=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(candyMachine,payer){var _state$whitelistMintS,_state$whitelistMintS2,_state$gatekeeper;var mint,userTokenAccountAddress,userPayingAccountAddress,candyMachineAddress,remainingAccounts,signers,cleanupInstructions,instructions,_mint,whitelistToken,whitelistBurnAuthority,exists,transferAuthority,metadataAddress,masterEdition,_yield$getCandyMachin,_yield$getCandyMachin2,candyMachineCreator,creatorBump,_yield$getCollectionP,_yield$getCollectionP2,collectionPDA,collectionPDAAccount,collectionData,collectionMint,collectionAuthorityRecord,collectionMetadata,collectionMasterEdition,instructionsMatrix,signersMatrix,state,txnEstimate,INIT_INSTRUCTIONS_LENGTH,INIT_SIGNERS_LENGTH,initInstructions,initSigners;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:mint=anchor.web3.Keypair.generate();_context10.next=3;return getAtaForMint(mint.publicKey,payer);case 3:userTokenAccountAddress=_context10.sent[0];if(!candyMachine.state.tokenMint){_context10.next=10;break;}_context10.next=7;return getAtaForMint(candyMachine.state.tokenMint,payer);case 7:_context10.t0=_context10.sent[0];_context10.next=11;break;case 10:_context10.t0=payer;case 11:userPayingAccountAddress=_context10.t0;candyMachineAddress=candyMachine.id;remainingAccounts=[];signers=[mint];cleanupInstructions=[];_context10.t1=anchor.web3.SystemProgram;_context10.t2=payer;_context10.t3=mint.publicKey;_context10.t4=MintLayout.span;_context10.next=22;return candyMachine.program.provider.connection.getMinimumBalanceForRentExemption(MintLayout.span);case 22:_context10.t5=_context10.sent;_context10.t6=TOKEN_PROGRAM_ID;_context10.t7={fromPubkey:_context10.t2,newAccountPubkey:_context10.t3,space:_context10.t4,lamports:_context10.t5,programId:_context10.t6};_context10.t8=_context10.t1.createAccount.call(_context10.t1,_context10.t7);_context10.t9=Token.createInitMintInstruction(TOKEN_PROGRAM_ID,mint.publicKey,0,payer,payer);_context10.t10=createAssociatedTokenAccountInstruction(userTokenAccountAddress,payer,payer,mint.publicKey);_context10.t11=Token.createMintToInstruction(TOKEN_PROGRAM_ID,mint.publicKey,userTokenAccountAddress,payer,[],1);instructions=[_context10.t8,_context10.t9,_context10.t10,_context10.t11];if(!candyMachine.state.gatekeeper){_context10.next=45;break;}_context10.t12=remainingAccounts;_context10.next=34;return getNetworkToken(payer,candyMachine.state.gatekeeper.gatekeeperNetwork);case 34:_context10.t13=_context10.sent[0];_context10.t14={pubkey:_context10.t13,isWritable:true,isSigner:false};_context10.t12.push.call(_context10.t12,_context10.t14);if(!candyMachine.state.gatekeeper.expireOnUse){_context10.next=45;break;}remainingAccounts.push({pubkey:CIVIC,isWritable:false,isSigner:false});_context10.t15=remainingAccounts;_context10.next=42;return getNetworkExpire(candyMachine.state.gatekeeper.gatekeeperNetwork);case 42:_context10.t16=_context10.sent[0];_context10.t17={pubkey:_context10.t16,isWritable:false,isSigner:false};_context10.t15.push.call(_context10.t15,_context10.t17);case 45:if(!candyMachine.state.whitelistMintSettings){_context10.next=60;break;}_mint=new anchor.web3.PublicKey(candyMachine.state.whitelistMintSettings.mint);_context10.next=49;return getAtaForMint(_mint,payer);case 49:whitelistToken=_context10.sent[0];remainingAccounts.push({pubkey:whitelistToken,isWritable:true,isSigner:false});if(!candyMachine.state.whitelistMintSettings.mode.burnEveryTime){_context10.next=60;break;}whitelistBurnAuthority=anchor.web3.Keypair.generate();remainingAccounts.push({pubkey:_mint,isWritable:true,isSigner:false});remainingAccounts.push({pubkey:whitelistBurnAuthority.publicKey,isWritable:false,isSigner:true});signers.push(whitelistBurnAuthority);_context10.next=58;return candyMachine.program.provider.connection.getAccountInfo(whitelistToken);case 58:exists=_context10.sent;if(exists){instructions.push(Token.createApproveInstruction(TOKEN_PROGRAM_ID,whitelistToken,whitelistBurnAuthority.publicKey,payer,[],1));cleanupInstructions.push(Token.createRevokeInstruction(TOKEN_PROGRAM_ID,whitelistToken,payer,[]));}case 60:if(candyMachine.state.tokenMint){transferAuthority=anchor.web3.Keypair.generate();signers.push(transferAuthority);remainingAccounts.push({pubkey:userPayingAccountAddress,isWritable:true,isSigner:false});remainingAccounts.push({pubkey:transferAuthority.publicKey,isWritable:false,isSigner:true});instructions.push(Token.createApproveInstruction(TOKEN_PROGRAM_ID,userPayingAccountAddress,transferAuthority.publicKey,payer,[],candyMachine.state.price.toNumber()));cleanupInstructions.push(Token.createRevokeInstruction(TOKEN_PROGRAM_ID,userPayingAccountAddress,payer,[]));}_context10.next=63;return getMetadata(mint.publicKey);case 63:metadataAddress=_context10.sent;_context10.next=66;return getMasterEdition(mint.publicKey);case 66:masterEdition=_context10.sent;_context10.next=69;return getCandyMachineCreator(candyMachineAddress);case 69:_yield$getCandyMachin=_context10.sent;_yield$getCandyMachin2=_slicedToArray(_yield$getCandyMachin,2);candyMachineCreator=_yield$getCandyMachin2[0];creatorBump=_yield$getCandyMachin2[1];console.log(remainingAccounts.map(function(rm){return rm.pubkey.toBase58();}));_context10.t18=instructions;_context10.next=77;return candyMachine.program.instruction.mintNft(creatorBump,{accounts:{candyMachine:candyMachineAddress,candyMachineCreator:candyMachineCreator,payer:payer,wallet:candyMachine.state.treasury,mint:mint.publicKey,metadata:metadataAddress,masterEdition:masterEdition,mintAuthority:payer,updateAuthority:payer,tokenMetadataProgram:TOKEN_METADATA_PROGRAM_ID,tokenProgram:TOKEN_PROGRAM_ID,systemProgram:SystemProgram.programId,rent:anchor.web3.SYSVAR_RENT_PUBKEY,clock:anchor.web3.SYSVAR_CLOCK_PUBKEY,recentBlockhashes:SYSVAR_SLOT_HASHES_PUBKEY,instructionSysvarAccount:anchor.web3.SYSVAR_INSTRUCTIONS_PUBKEY},remainingAccounts:remainingAccounts.length>0?remainingAccounts:undefined});case 77:_context10.t19=_context10.sent;_context10.t18.push.call(_context10.t18,_context10.t19);_context10.next=81;return getCollectionPDA(candyMachineAddress);case 81:_yield$getCollectionP=_context10.sent;_yield$getCollectionP2=_slicedToArray(_yield$getCollectionP,1);collectionPDA=_yield$getCollectionP2[0];_context10.next=86;return candyMachine.program.provider.connection.getAccountInfo(collectionPDA);case 86:collectionPDAAccount=_context10.sent;if(!(collectionPDAAccount&&candyMachine.state.retainAuthority)){_context10.next=117;break;}_context10.prev=88;_context10.next=91;return candyMachine.program.account.collectionPda.fetch(collectionPDA);case 91:collectionData=_context10.sent;console.log(collectionData);collectionMint=collectionData.mint;_context10.next=96;return getCollectionAuthorityRecordPDA(collectionMint,collectionPDA);case 96:collectionAuthorityRecord=_context10.sent;console.log(collectionMint);if(!collectionMint){_context10.next=112;break;}_context10.next=101;return getMetadata(collectionMint);case 101:collectionMetadata=_context10.sent;_context10.next=104;return getMasterEdition(collectionMint);case 104:collectionMasterEdition=_context10.sent;console.log('Collection PDA: ',collectionPDA.toBase58());console.log('Authority: ',candyMachine.state.authority.toBase58());_context10.t20=instructions;_context10.next=110;return candyMachine.program.instruction.setCollectionDuringMint({accounts:{candyMachine:candyMachineAddress,metadata:metadataAddress,payer:payer,collectionPda:collectionPDA,tokenMetadataProgram:TOKEN_METADATA_PROGRAM_ID,instructions:anchor.web3.SYSVAR_INSTRUCTIONS_PUBKEY,collectionMint:collectionMint,collectionMetadata:collectionMetadata,collectionMasterEdition:collectionMasterEdition,authority:candyMachine.state.authority,collectionAuthorityRecord:collectionAuthorityRecord}});case 110:_context10.t21=_context10.sent;_context10.t20.push.call(_context10.t20,_context10.t21);case 112:_context10.next=117;break;case 114:_context10.prev=114;_context10.t22=_context10[\"catch\"](88);console.error(_context10.t22);case 117:instructionsMatrix=[];signersMatrix=[];state=candyMachine.state;txnEstimate=892+(collectionPDAAccount&&state.retainAuthority?132:0)+(state.tokenMint?145:0)+(state.whitelistMintSettings?33:0)+((_state$whitelistMintS=state.whitelistMintSettings)!==null&&_state$whitelistMintS!==void 0&&(_state$whitelistMintS2=_state$whitelistMintS.mode)!==null&&_state$whitelistMintS2!==void 0&&_state$whitelistMintS2.burnEveryTime?145:0)+(state.gatekeeper?33:0)+((_state$gatekeeper=state.gatekeeper)!==null&&_state$gatekeeper!==void 0&&_state$gatekeeper.expireOnUse?66:0);INIT_INSTRUCTIONS_LENGTH=4;INIT_SIGNERS_LENGTH=1;console.log('Transaction estimate: ',txnEstimate);if(txnEstimate>1230){initInstructions=instructions.splice(0,INIT_INSTRUCTIONS_LENGTH);console.log(initInstructions);instructionsMatrix.push(initInstructions);initSigners=signers.splice(0,INIT_SIGNERS_LENGTH);signersMatrix.push(initSigners);}instructionsMatrix.push(instructions);signersMatrix.push(signers);if(cleanupInstructions.length>0){instructionsMatrix.push(cleanupInstructions);signersMatrix.push([]);}_context10.prev=128;_context10.next=131;return sendTransactions(candyMachine.program.provider.connection,candyMachine.program.provider.wallet,instructionsMatrix,signersMatrix);case 131:return _context10.abrupt(\"return\",_context10.sent.txs.map(function(t){return t.txid;}));case 134:_context10.prev=134;_context10.t23=_context10[\"catch\"](128);console.log(_context10.t23);case 137:return _context10.abrupt(\"return\",[]);case 138:case\"end\":return _context10.stop();}}},_callee10,null,[[88,114],[128,134]]);}));return function mintOneToken(_x15,_x16){return _ref10.apply(this,arguments);};}();export var shortenAddress=function shortenAddress(address){var chars=arguments.length>1&&arguments[1]!==undefined?arguments[1]:4;return\"\".concat(address.slice(0,chars),\"...\").concat(address.slice(-chars));};var sleep=function sleep(ms){return new Promise(function(resolve){return setTimeout(resolve,ms);});};","map":{"version":3,"sources":["/home/drawmardock/Desktop/dapp/solana-nft/metaplex/js/packages/candy-machine-ui/src/candy-machine.ts"],"names":["anchor","MintLayout","TOKEN_PROGRAM_ID","Token","SystemProgram","SYSVAR_SLOT_HASHES_PUBKEY","sendTransactions","CIVIC","getAtaForMint","getNetworkExpire","getNetworkToken","SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID","CANDY_MACHINE_PROGRAM","web3","PublicKey","TOKEN_METADATA_PROGRAM_ID","awaitTransactionSignatureConfirmation","txid","timeout","connection","queryStatus","done","status","slot","confirmations","err","subId","Promise","resolve","reject","setTimeout","console","log","getSignatureStatuses","signatureStatuses","value","sleep","_signatureSubscriptions","removeSignatureListener","createAssociatedTokenAccountInstruction","associatedTokenAddress","payer","walletAddress","splTokenMintAddress","keys","pubkey","isSigner","isWritable","programId","SYSVAR_RENT_PUBKEY","TransactionInstruction","data","Buffer","from","getCandyMachineState","anchorWallet","candyMachineId","provider","Provider","preflightCommitment","Program","fetchIdl","idl","program","account","candyMachine","fetch","state","itemsAvailable","toNumber","itemsRedeemed","itemsRemaining","id","authority","isSoldOut","isActive","isPresale","isWhitelistOnly","goLiveDate","treasury","wallet","tokenMint","gatekeeper","endSettings","whitelistMintSettings","hiddenSettings","price","retainAuthority","getMasterEdition","mint","findProgramAddress","toBuffer","getMetadata","getCandyMachineCreator","getCollectionPDA","candyMachineAddress","getCollectionAuthorityRecordPDA","newAuthority","mintOneToken","Keypair","generate","publicKey","userTokenAccountAddress","userPayingAccountAddress","remainingAccounts","signers","cleanupInstructions","span","getMinimumBalanceForRentExemption","fromPubkey","newAccountPubkey","space","lamports","createAccount","createInitMintInstruction","createMintToInstruction","instructions","gatekeeperNetwork","push","expireOnUse","whitelistToken","mode","burnEveryTime","whitelistBurnAuthority","getAccountInfo","exists","createApproveInstruction","createRevokeInstruction","transferAuthority","metadataAddress","masterEdition","candyMachineCreator","creatorBump","map","rm","toBase58","instruction","mintNft","accounts","metadata","mintAuthority","updateAuthority","tokenMetadataProgram","tokenProgram","systemProgram","rent","clock","SYSVAR_CLOCK_PUBKEY","recentBlockhashes","instructionSysvarAccount","SYSVAR_INSTRUCTIONS_PUBKEY","length","undefined","collectionPDA","collectionPDAAccount","collectionPda","collectionData","collectionMint","collectionAuthorityRecord","collectionMetadata","collectionMasterEdition","setCollectionDuringMint","error","instructionsMatrix","signersMatrix","txnEstimate","INIT_INSTRUCTIONS_LENGTH","INIT_SIGNERS_LENGTH","initInstructions","splice","initSigners","txs","t","shortenAddress","address","chars","slice","ms"],"mappings":"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","sourcesContent":["import * as anchor from '@project-serum/anchor';\n\nimport { MintLayout, TOKEN_PROGRAM_ID, Token } from '@solana/spl-token';\nimport { SystemProgram, SYSVAR_SLOT_HASHES_PUBKEY } from '@solana/web3.js';\nimport { sendTransactions } from './connection';\n\nimport {\n  CIVIC,\n  getAtaForMint,\n  getNetworkExpire,\n  getNetworkToken,\n  SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\n} from './utils';\n\nexport const CANDY_MACHINE_PROGRAM = new anchor.web3.PublicKey(\n  'cndy3Z4yapfJBmL3ShUp5exZKqR3z33thTzeNMm2gRZ',\n);\n\nconst TOKEN_METADATA_PROGRAM_ID = new anchor.web3.PublicKey(\n  'metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s',\n);\n\ninterface CandyMachineState {\n  authority: anchor.web3.PublicKey;\n  itemsAvailable: number;\n  itemsRedeemed: number;\n  itemsRemaining: number;\n  treasury: anchor.web3.PublicKey;\n  tokenMint: anchor.web3.PublicKey;\n  isSoldOut: boolean;\n  isActive: boolean;\n  isPresale: boolean;\n  isWhitelistOnly: boolean;\n  goLiveDate: anchor.BN;\n  price: anchor.BN;\n  gatekeeper: null | {\n    expireOnUse: boolean;\n    gatekeeperNetwork: anchor.web3.PublicKey;\n  };\n  endSettings: null | {\n    number: anchor.BN;\n    endSettingType: any;\n  };\n  whitelistMintSettings: null | {\n    mode: any;\n    mint: anchor.web3.PublicKey;\n    presale: boolean;\n    discountPrice: null | anchor.BN;\n  };\n  hiddenSettings: null | {\n    name: string;\n    uri: string;\n    hash: Uint8Array;\n  };\n  retainAuthority: boolean;\n}\n\nexport interface CandyMachineAccount {\n  id: anchor.web3.PublicKey;\n  program: anchor.Program;\n  state: CandyMachineState;\n}\n\nexport const awaitTransactionSignatureConfirmation = async (\n  txid: anchor.web3.TransactionSignature,\n  timeout: number,\n  connection: anchor.web3.Connection,\n  queryStatus = false,\n): Promise<anchor.web3.SignatureStatus | null | void> => {\n  let done = false;\n  let status: anchor.web3.SignatureStatus | null | void = {\n    slot: 0,\n    confirmations: 0,\n    err: null,\n  };\n  let subId = 0;\n  status = await new Promise(async (resolve, reject) => {\n    setTimeout(() => {\n      if (done) {\n        return;\n      }\n      done = true;\n      console.log('Rejecting for timeout...');\n      reject({ timeout: true });\n    }, timeout);\n\n    while (!done && queryStatus) {\n      // eslint-disable-next-line no-loop-func\n      (async () => {\n        try {\n          const signatureStatuses = await connection.getSignatureStatuses([\n            txid,\n          ]);\n          status = signatureStatuses && signatureStatuses.value[0];\n          if (!done) {\n            if (!status) {\n              console.log('REST null result for', txid, status);\n            } else if (status.err) {\n              console.log('REST error for', txid, status);\n              done = true;\n              reject(status.err);\n            } else if (!status.confirmations) {\n              console.log('REST no confirmations for', txid, status);\n            } else {\n              console.log('REST confirmation for', txid, status);\n              done = true;\n              resolve(status);\n            }\n          }\n        } catch (e) {\n          if (!done) {\n            console.log('REST connection error: txid', txid, e);\n          }\n        }\n      })();\n      await sleep(2000);\n    }\n  });\n\n  //@ts-ignore\n  if (connection._signatureSubscriptions[subId]) {\n    connection.removeSignatureListener(subId);\n  }\n  done = true;\n  console.log('Returning status', status);\n  return status;\n};\n\nconst createAssociatedTokenAccountInstruction = (\n  associatedTokenAddress: anchor.web3.PublicKey,\n  payer: anchor.web3.PublicKey,\n  walletAddress: anchor.web3.PublicKey,\n  splTokenMintAddress: anchor.web3.PublicKey,\n) => {\n  const keys = [\n    { pubkey: payer, isSigner: true, isWritable: true },\n    { pubkey: associatedTokenAddress, isSigner: false, isWritable: true },\n    { pubkey: walletAddress, isSigner: false, isWritable: false },\n    { pubkey: splTokenMintAddress, isSigner: false, isWritable: false },\n    {\n      pubkey: anchor.web3.SystemProgram.programId,\n      isSigner: false,\n      isWritable: false,\n    },\n    { pubkey: TOKEN_PROGRAM_ID, isSigner: false, isWritable: false },\n    {\n      pubkey: anchor.web3.SYSVAR_RENT_PUBKEY,\n      isSigner: false,\n      isWritable: false,\n    },\n  ];\n  return new anchor.web3.TransactionInstruction({\n    keys,\n    programId: SPL_ASSOCIATED_TOKEN_ACCOUNT_PROGRAM_ID,\n    data: Buffer.from([]),\n  });\n};\n\nexport const getCandyMachineState = async (\n  anchorWallet: anchor.Wallet,\n  candyMachineId: anchor.web3.PublicKey,\n  connection: anchor.web3.Connection,\n): Promise<CandyMachineAccount> => {\n  const provider = new anchor.Provider(connection, anchorWallet, {\n    preflightCommitment: 'processed',\n  });\n\n  const idl = await anchor.Program.fetchIdl(CANDY_MACHINE_PROGRAM, provider);\n\n  const program = new anchor.Program(idl!, CANDY_MACHINE_PROGRAM, provider);\n\n  const state: any = await program.account.candyMachine.fetch(candyMachineId);\n  const itemsAvailable = state.data.itemsAvailable.toNumber();\n  const itemsRedeemed = state.itemsRedeemed.toNumber();\n  const itemsRemaining = itemsAvailable - itemsRedeemed;\n\n  return {\n    id: candyMachineId,\n    program,\n    state: {\n      authority: state.authority,\n      itemsAvailable,\n      itemsRedeemed,\n      itemsRemaining,\n      isSoldOut: itemsRemaining === 0,\n      isActive: false,\n      isPresale: false,\n      isWhitelistOnly: false,\n      goLiveDate: state.data.goLiveDate,\n      treasury: state.wallet,\n      tokenMint: state.tokenMint,\n      gatekeeper: state.data.gatekeeper,\n      endSettings: state.data.endSettings,\n      whitelistMintSettings: state.data.whitelistMintSettings,\n      hiddenSettings: state.data.hiddenSettings,\n      price: state.data.price,\n      retainAuthority: state.data.retainAuthority,\n    },\n  };\n};\n\nconst getMasterEdition = async (\n  mint: anchor.web3.PublicKey,\n): Promise<anchor.web3.PublicKey> => {\n  return (\n    await anchor.web3.PublicKey.findProgramAddress(\n      [\n        Buffer.from('metadata'),\n        TOKEN_METADATA_PROGRAM_ID.toBuffer(),\n        mint.toBuffer(),\n        Buffer.from('edition'),\n      ],\n      TOKEN_METADATA_PROGRAM_ID,\n    )\n  )[0];\n};\n\nconst getMetadata = async (\n  mint: anchor.web3.PublicKey,\n): Promise<anchor.web3.PublicKey> => {\n  return (\n    await anchor.web3.PublicKey.findProgramAddress(\n      [\n        Buffer.from('metadata'),\n        TOKEN_METADATA_PROGRAM_ID.toBuffer(),\n        mint.toBuffer(),\n      ],\n      TOKEN_METADATA_PROGRAM_ID,\n    )\n  )[0];\n};\n\nexport const getCandyMachineCreator = async (\n  candyMachine: anchor.web3.PublicKey,\n): Promise<[anchor.web3.PublicKey, number]> => {\n  return await anchor.web3.PublicKey.findProgramAddress(\n    [Buffer.from('candy_machine'), candyMachine.toBuffer()],\n    CANDY_MACHINE_PROGRAM,\n  );\n};\n\nexport const getCollectionPDA = async (\n  candyMachineAddress: anchor.web3.PublicKey,\n): Promise<[anchor.web3.PublicKey, number]> => {\n  return await anchor.web3.PublicKey.findProgramAddress(\n    [Buffer.from('collection'), candyMachineAddress.toBuffer()],\n    CANDY_MACHINE_PROGRAM,\n  );\n};\n\nexport interface CollectionData {\n  mint: anchor.web3.PublicKey;\n  candyMachine: anchor.web3.PublicKey;\n}\n\nexport const getCollectionAuthorityRecordPDA = async (\n  mint: anchor.web3.PublicKey,\n  newAuthority: anchor.web3.PublicKey,\n): Promise<anchor.web3.PublicKey> => {\n  return (\n    await anchor.web3.PublicKey.findProgramAddress(\n      [\n        Buffer.from('metadata'),\n        TOKEN_METADATA_PROGRAM_ID.toBuffer(),\n        mint.toBuffer(),\n        Buffer.from('collection_authority'),\n        newAuthority.toBuffer(),\n      ],\n      TOKEN_METADATA_PROGRAM_ID,\n    )\n  )[0];\n};\n\nexport const mintOneToken = async (\n  candyMachine: CandyMachineAccount,\n  payer: anchor.web3.PublicKey,\n): Promise<(string | undefined)[]> => {\n  const mint = anchor.web3.Keypair.generate();\n\n  const userTokenAccountAddress = (\n    await getAtaForMint(mint.publicKey, payer)\n  )[0];\n\n  const userPayingAccountAddress = candyMachine.state.tokenMint\n    ? (await getAtaForMint(candyMachine.state.tokenMint, payer))[0]\n    : payer;\n\n  const candyMachineAddress = candyMachine.id;\n\n  const remainingAccounts = [];\n  const signers: anchor.web3.Keypair[] = [mint];\n  const cleanupInstructions = [];\n  const instructions = [\n    anchor.web3.SystemProgram.createAccount({\n      fromPubkey: payer,\n      newAccountPubkey: mint.publicKey,\n      space: MintLayout.span,\n      lamports:\n        await candyMachine.program.provider.connection.getMinimumBalanceForRentExemption(\n          MintLayout.span,\n        ),\n      programId: TOKEN_PROGRAM_ID,\n    }),\n    Token.createInitMintInstruction(\n      TOKEN_PROGRAM_ID,\n      mint.publicKey,\n      0,\n      payer,\n      payer,\n    ),\n    createAssociatedTokenAccountInstruction(\n      userTokenAccountAddress,\n      payer,\n      payer,\n      mint.publicKey,\n    ),\n    Token.createMintToInstruction(\n      TOKEN_PROGRAM_ID,\n      mint.publicKey,\n      userTokenAccountAddress,\n      payer,\n      [],\n      1,\n    ),\n  ];\n\n  if (candyMachine.state.gatekeeper) {\n    remainingAccounts.push({\n      pubkey: (\n        await getNetworkToken(\n          payer,\n          candyMachine.state.gatekeeper.gatekeeperNetwork,\n        )\n      )[0],\n      isWritable: true,\n      isSigner: false,\n    });\n\n    if (candyMachine.state.gatekeeper.expireOnUse) {\n      remainingAccounts.push({\n        pubkey: CIVIC,\n        isWritable: false,\n        isSigner: false,\n      });\n      remainingAccounts.push({\n        pubkey: (\n          await getNetworkExpire(\n            candyMachine.state.gatekeeper.gatekeeperNetwork,\n          )\n        )[0],\n        isWritable: false,\n        isSigner: false,\n      });\n    }\n  }\n  if (candyMachine.state.whitelistMintSettings) {\n    const mint = new anchor.web3.PublicKey(\n      candyMachine.state.whitelistMintSettings.mint,\n    );\n\n    const whitelistToken = (await getAtaForMint(mint, payer))[0];\n    remainingAccounts.push({\n      pubkey: whitelistToken,\n      isWritable: true,\n      isSigner: false,\n    });\n\n    if (candyMachine.state.whitelistMintSettings.mode.burnEveryTime) {\n      const whitelistBurnAuthority = anchor.web3.Keypair.generate();\n\n      remainingAccounts.push({\n        pubkey: mint,\n        isWritable: true,\n        isSigner: false,\n      });\n      remainingAccounts.push({\n        pubkey: whitelistBurnAuthority.publicKey,\n        isWritable: false,\n        isSigner: true,\n      });\n      signers.push(whitelistBurnAuthority);\n      const exists =\n        await candyMachine.program.provider.connection.getAccountInfo(\n          whitelistToken,\n        );\n      if (exists) {\n        instructions.push(\n          Token.createApproveInstruction(\n            TOKEN_PROGRAM_ID,\n            whitelistToken,\n            whitelistBurnAuthority.publicKey,\n            payer,\n            [],\n            1,\n          ),\n        );\n        cleanupInstructions.push(\n          Token.createRevokeInstruction(\n            TOKEN_PROGRAM_ID,\n            whitelistToken,\n            payer,\n            [],\n          ),\n        );\n      }\n    }\n  }\n\n  if (candyMachine.state.tokenMint) {\n    const transferAuthority = anchor.web3.Keypair.generate();\n\n    signers.push(transferAuthority);\n    remainingAccounts.push({\n      pubkey: userPayingAccountAddress,\n      isWritable: true,\n      isSigner: false,\n    });\n    remainingAccounts.push({\n      pubkey: transferAuthority.publicKey,\n      isWritable: false,\n      isSigner: true,\n    });\n\n    instructions.push(\n      Token.createApproveInstruction(\n        TOKEN_PROGRAM_ID,\n        userPayingAccountAddress,\n        transferAuthority.publicKey,\n        payer,\n        [],\n        candyMachine.state.price.toNumber(),\n      ),\n    );\n    cleanupInstructions.push(\n      Token.createRevokeInstruction(\n        TOKEN_PROGRAM_ID,\n        userPayingAccountAddress,\n        payer,\n        [],\n      ),\n    );\n  }\n  const metadataAddress = await getMetadata(mint.publicKey);\n  const masterEdition = await getMasterEdition(mint.publicKey);\n\n  const [candyMachineCreator, creatorBump] = await getCandyMachineCreator(\n    candyMachineAddress,\n  );\n\n  console.log(remainingAccounts.map(rm => rm.pubkey.toBase58()));\n  instructions.push(\n    await candyMachine.program.instruction.mintNft(creatorBump, {\n      accounts: {\n        candyMachine: candyMachineAddress,\n        candyMachineCreator,\n        payer: payer,\n        wallet: candyMachine.state.treasury,\n        mint: mint.publicKey,\n        metadata: metadataAddress,\n        masterEdition,\n        mintAuthority: payer,\n        updateAuthority: payer,\n        tokenMetadataProgram: TOKEN_METADATA_PROGRAM_ID,\n        tokenProgram: TOKEN_PROGRAM_ID,\n        systemProgram: SystemProgram.programId,\n        rent: anchor.web3.SYSVAR_RENT_PUBKEY,\n        clock: anchor.web3.SYSVAR_CLOCK_PUBKEY,\n        recentBlockhashes: SYSVAR_SLOT_HASHES_PUBKEY,\n        instructionSysvarAccount: anchor.web3.SYSVAR_INSTRUCTIONS_PUBKEY,\n      },\n      remainingAccounts:\n        remainingAccounts.length > 0 ? remainingAccounts : undefined,\n    }),\n  );\n\n  const [collectionPDA] = await getCollectionPDA(candyMachineAddress);\n  const collectionPDAAccount =\n    await candyMachine.program.provider.connection.getAccountInfo(\n      collectionPDA,\n    );\n\n  if (collectionPDAAccount && candyMachine.state.retainAuthority) {\n    try {\n      const collectionData =\n        (await candyMachine.program.account.collectionPda.fetch(\n          collectionPDA,\n        )) as CollectionData;\n      console.log(collectionData);\n      const collectionMint = collectionData.mint;\n      const collectionAuthorityRecord = await getCollectionAuthorityRecordPDA(\n        collectionMint,\n        collectionPDA,\n      );\n      console.log(collectionMint);\n      if (collectionMint) {\n        const collectionMetadata = await getMetadata(collectionMint);\n        const collectionMasterEdition = await getMasterEdition(collectionMint);\n        console.log('Collection PDA: ', collectionPDA.toBase58());\n        console.log('Authority: ', candyMachine.state.authority.toBase58());\n        instructions.push(\n          await candyMachine.program.instruction.setCollectionDuringMint({\n            accounts: {\n              candyMachine: candyMachineAddress,\n              metadata: metadataAddress,\n              payer: payer,\n              collectionPda: collectionPDA,\n              tokenMetadataProgram: TOKEN_METADATA_PROGRAM_ID,\n              instructions: anchor.web3.SYSVAR_INSTRUCTIONS_PUBKEY,\n              collectionMint,\n              collectionMetadata,\n              collectionMasterEdition,\n              authority: candyMachine.state.authority,\n              collectionAuthorityRecord,\n            },\n          }),\n        );\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  const instructionsMatrix: anchor.web3.TransactionInstruction[][] = [];\n  const signersMatrix: anchor.web3.Keypair[][] = [];\n\n  const state = candyMachine.state;\n  const txnEstimate =\n    892 +\n    (collectionPDAAccount && state.retainAuthority ? 132 : 0) +\n    (state.tokenMint ? 145 : 0) +\n    (state.whitelistMintSettings ? 33 : 0) +\n    (state.whitelistMintSettings?.mode?.burnEveryTime ? 145 : 0) +\n    (state.gatekeeper ? 33 : 0) +\n    (state.gatekeeper?.expireOnUse ? 66 : 0);\n\n  const INIT_INSTRUCTIONS_LENGTH = 4;\n  const INIT_SIGNERS_LENGTH = 1;\n\n  console.log('Transaction estimate: ', txnEstimate);\n  if (txnEstimate > 1230) {\n    const initInstructions = instructions.splice(0, INIT_INSTRUCTIONS_LENGTH);\n    console.log(initInstructions);\n    instructionsMatrix.push(initInstructions);\n    const initSigners = signers.splice(0, INIT_SIGNERS_LENGTH);\n    signersMatrix.push(initSigners);\n  }\n\n  instructionsMatrix.push(instructions);\n  signersMatrix.push(signers);\n\n  if (cleanupInstructions.length > 0) {\n    instructionsMatrix.push(cleanupInstructions);\n    signersMatrix.push([]);\n  }\n\n  try {\n    return (\n      await sendTransactions(\n        candyMachine.program.provider.connection,\n        candyMachine.program.provider.wallet,\n        instructionsMatrix,\n        signersMatrix,\n      )\n    ).txs.map(t => t.txid);\n  } catch (e) {\n    console.log(e);\n  }\n\n  return [];\n};\n\nexport const shortenAddress = (address: string, chars = 4): string => {\n  return `${address.slice(0, chars)}...${address.slice(-chars)}`;\n};\n\nconst sleep = (ms: number): Promise<void> => {\n  return new Promise(resolve => setTimeout(resolve, ms));\n};\n"]},"metadata":{},"sourceType":"module"}